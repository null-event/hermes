//
//  config.swift
//  Hermes
//
//  Created by slyd0g on 5/23/21.
//  Updated to support multiple C2 profiles
//

import Foundation

struct AgentConfig {
    // Mythic components
    var payloadUUID: String
    var encodedAESKey: String
    
    // C2 Profile Selection
    var c2ProfileType: String
    
    // Common C2 components (used by all profiles)
    var callbackHost: String
    var callbackPort: Int
    var userAgent: String
    var hostHeader: String
    var useSSL: Bool
    var httpHeaders: Dictionary<String,String>
    
    // HTTP Profile specific components
    var getRequestURI: String
    var postRequestURI: String
    var queryParameter: String
    
    // WebSocket Profile specific components
    var websocketEndpoint: String
    
    // GitHub Profile specific components
    var githubRepo: String
    var githubUsername: String
    var githubToken: String
    var githubServerIssue: Int
    var githubClientIssue: Int
    
    // Agent components
    var sleep: Int32
    var jitter: Int32
    var killDate: String //year-month-day, ex. 1994-01-05
}

var agentConfig = AgentConfig(
    payloadUUID: "REPLACE_PAYLOAD_UUID",
    encodedAESKey: "REPLACE_ENCODED_AES_KEY",
    
    c2ProfileType: "REPLACE_C2_PROFILE_TYPE",
    
    callbackHost: "REPLACE_CALLBACK_HOST",
    callbackPort: REPLACE_CALLBACK_PORT,
    userAgent: "REPLACE_USER_AGENT",
    hostHeader: "REPLACE_HOST_HEADER",
    useSSL: REPLACE_USE_SSL,
    httpHeaders: [REPLACE_HTTP_HEADERS],
    
    getRequestURI: "REPLACE_GET_REQUEST_URI",
    postRequestURI: "REPLACE_POST_REQUEST_URI",
    queryParameter: "REPLACE_QUERY_PARAMETER",
    
    websocketEndpoint: "REPLACE_WEBSOCKET_ENDPOINT",
    
    githubRepo: "REPLACE_GITHUB_REPO",
    githubUsername: "REPLACE_GITHUB_USERNAME",
    githubToken: "REPLACE_GITHUB_TOKEN",
    githubServerIssue: REPLACE_GITHUB_SERVER_ISSUE,
    githubClientIssue: REPLACE_GITHUB_CLIENT_ISSUE,
    
    sleep: REPLACE_SLEEP,
    jitter: REPLACE_JITTER,
    killDate: "REPLACE_KILL_DATE"
)
